import{R as p,r as t,j as e}from"./jsx-runtime-DexIYAB0.js";/* empty css              */import{b as E,C as T,T as w,a as d}from"./toastMessage-BoDQuLRo.js";import g from"./variables-EC5tLZZH.js";import{g as A,a as C}from"./components-BnUS28CX.js";import{P as M,B,C as x}from"./Page-g_6naJ0r.js";import"./index-BmgK8DIy.js";import"./Toast-Ckam4cjg.js";var f=function(c){return p.createElement("svg",Object.assign({viewBox:"0 0 20 20"},c),p.createElement("path",{fillRule:"evenodd",d:"M16.5 10a.75.75 0 0 1-.75.75h-9.69l2.72 2.72a.75.75 0 0 1-1.06 1.06l-4-4a.75.75 0 0 1 0-1.06l4-4a.75.75 0 1 1 1.06 1.06l-2.72 2.72h9.69a.75.75 0 0 1 .75.75Z"}))};f.displayName="ArrowLeftIcon";function G(){const[i,c]=t.useState(""),n=A().t_id,o=E(),[h,j]=t.useState([]),[v,k]=t.useState([]),[S,a]=t.useState(!0),[N,l]=t.useState(!1),[b,u]=t.useState(""),_=t.useCallback(()=>l(s=>!s),[]),m=async()=>{a(!0),d.get(`${g.API_URL}/chats`,{params:{store_id:o.config.shop,ticket_id:n}}).then(s=>{j(s.data.data),a(!1)}).catch(s=>{console.log("Error: ",s)})},L=async()=>{a(!0),d.get(`${g.API_URL}/ticket/get`,{params:{store_id:o.config.shop,ticket_id:n}}).then(s=>{s.data.status===!0&&k(s.data.data[0]),a(!1)}).catch(s=>{console.log("Error: ",s)})},y=s=>{s.preventDefault(),a(!0);var R=i,I={sender:"assistant",message:R,ticket_id:n,chat_index:h.length+1,messageDateTime:new Date().toISOString()};d.post(`${g.API_URL}/chats/new`,I,{params:{store_id:o.config.shop}}).then(r=>{r.data.success===!0?(m(),a(!1),l(!0),u(r.data.message)):(m(),l(!0),u(r.data.message)),c("")}).catch(r=>{console.log(`this is error: ${r}`)})};return t.useEffect(()=>{m(),L()},[]),e.jsx(e.Fragment,{children:e.jsxs(M,{children:[S?e.jsx(T,{}):"",e.jsxs(B,{gap:"200",children:[e.jsx(x,{children:e.jsx("div",{className:"back_to_tickets",children:e.jsxs(C,{to:"/app",children:[e.jsx(f,{})," Back to tickets"]})})}),e.jsx(x,{children:e.jsxs("section",{className:"msger",children:[e.jsxs("header",{className:"msger-header",children:[e.jsx("div",{className:"msger-header-title",children:v.subject}),e.jsx("div",{className:"msger-header-options",children:e.jsx("span",{children:e.jsx("i",{className:"fas fa-cog"})})})]}),e.jsx("main",{className:"msger-chat",children:h.map(s=>e.jsx("div",{className:s.sender=="user"?"msg left-msg":"msg right-msg",children:e.jsxs("div",{className:"msg-bubble",children:[e.jsx("div",{className:"msg-info",children:e.jsx("div",{className:"msg-info-name",children:s.sender})}),e.jsx("div",{className:"msg-text",children:s.message})]})}))}),e.jsxs("form",{className:"msger-inputarea",onSubmit:y,children:[e.jsx("input",{type:"text",className:"msger-input",value:i,placeholder:"Enter your message...",onChange:s=>c(s.target.value)}),e.jsx("button",{type:"submit",className:"msger-send-btn",children:"Send"})]})]})})]}),N?e.jsx(w,{message:b,toggle:_}):""]})})}export{G as default};
