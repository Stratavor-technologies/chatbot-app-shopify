import{r as t,j as e}from"./jsx-runtime-DexIYAB0.js";import{b as D,C as $,T as N,a as E}from"./toastMessage-BoDQuLRo.js";import T from"./variables-EC5tLZZH.js";/* empty css              */import{P as V,B as z,C as U,T as H,a as p,b as J}from"./Page-g_6naJ0r.js";import{L as O}from"./Toast-Ckam4cjg.js";import{R as c}from"./RadioButton-POZI-aKh.js";import"./index-BmgK8DIy.js";function se(){const[s,i]=t.useState(""),[n,f]=t.useState(""),[l,v]=t.useState(""),[g,h]=t.useState(""),[u,x]=t.useState(""),[A,d]=t.useState(""),[B,m]=t.useState(""),[G,y]=t.useState(""),[K,o]=t.useState(!1),[P,L]=t.useState(""),[R,j]=t.useState(!1),S=D(),M=t.useCallback(()=>j(a=>!a),[]),F=async()=>{var a={};if(d(""),m(""),s=="gorgias"){if(n||d("Username (your email address) is required"),l||m("Password (API Key) is required"),g||y("Base API URL is required"),!n||!l||!g)return!1;a={apiUrl:g,email:n,apiKey:l}}s=="admin"&&x({type:s}),x({type:s,value:a})},q=async()=>{if(u){o(!0);var a={integration:u,integration_type:s};await E.put(`${T.API_URL}/stores/update`,a,{params:{store_id:S.config.shop}}).then(r=>{r.data.success===!0?setTimeout(()=>{L("Data Updated!"),j(!0),o(!1)},500):setTimeout(()=>{y("Invalid Base Url!"),d("Invalid Email!"),m("Invalid Key!"),o(!1)},500)}).catch(r=>{console.log(r)})}},w=()=>{o(!0),E.get(`${T.API_URL}/stores/get`,{params:{store_id:S.config.shop}}).then(a=>{var r,b,k,I,C,_;a.data.success===!0&&(i(a.data.data.integration_type),h((b=(r=a.data.data.integration)==null?void 0:r.value)==null?void 0:b.apiUrl),f((I=(k=a.data.data.integration)==null?void 0:k.value)==null?void 0:I.email),v((_=(C=a.data.data.integration)==null?void 0:C.value)==null?void 0:_.apiKey),setTimeout(()=>{o(!1)},500))}).catch(a=>{console.log(a)})};return t.useEffect(()=>{q()},[u]),t.useEffect(()=>{w()},[]),e.jsx(e.Fragment,{children:e.jsxs(V,{children:[K?e.jsx($,{}):"",e.jsxs(z,{gap:"200",children:[e.jsx(U,{children:e.jsx(H,{variant:"headingMd",as:"h2",children:"Integration"})}),e.jsx(U,{children:e.jsx(O,{vertical:!0,children:e.jsxs("form",{children:[e.jsx(c,{label:"Gorgias",helpText:"Get tickets and replies on Gorgias",checked:s=="gorgias",name:"gorgias_integration",value:"gorgias",onChange:()=>i(event.target.value)}),e.jsxs("div",{className:"gorgias_integration_api_keys",style:{display:s=="gorgias"?"block":"none"},children:[e.jsx(p,{label:"Base API URL",value:g,onChange:()=>h(event.target.value),name:"gorgias_api_url",autoComplete:"off",error:G}),e.jsx(p,{label:"Username (your email address)",value:n,onChange:()=>f(event.target.value),name:"gorgias_email",autoComplete:"off",error:A}),e.jsx(p,{label:"Password (API Key)",value:l,onChange:()=>v(event.target.value),name:"gorgias_key",autoComplete:"off",error:B})]}),e.jsx(c,{label:"Instagram",helpText:"Get replies on Instagram",checked:s=="instagram",name:"insta_integration",value:"instagram",onChange:a=>i(event.target.value)}),e.jsx(c,{label:"Facebook",helpText:"Get replies on Facebook",checked:s=="facebook",name:"facebook_integration",value:"facebook",onChange:a=>i(event.target.value)}),e.jsx(c,{label:"Shopify Admin",helpText:"Get replies on Sopify admin",checked:s=="admin",name:"admin",value:"admin",onChange:a=>i(event.target.value)}),e.jsx(J,{onClick:F,children:"Save"})]})})})]}),R?e.jsx(N,{message:P,toggle:M}):""]})})}export{se as default};
