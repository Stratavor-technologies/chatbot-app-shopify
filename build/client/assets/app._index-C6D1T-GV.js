import{r as a,j as t}from"./jsx-runtime-DexIYAB0.js";import{b as v,C as $,T as y,a as n}from"./toastMessage-BoDQuLRo.js";import d from"./variables-EC5tLZZH.js";/* empty css              */import{P as L,B as b,C as D,T as I,c as A,b as p}from"./Page-g_6naJ0r.js";import{L as B,D as M}from"./DataTable-Cc8KQHKZ.js";import{a as w}from"./components-BnUS28CX.js";import"./index-BmgK8DIy.js";import"./Toast-Ckam4cjg.js";function q(){const[u,h]=a.useState([]),[x,r]=a.useState(!0),[m,f]=a.useState(!1),[j,k]=a.useState(""),[T,S]=a.useState(""),i=v(),l=a.useCallback(()=>f(e=>!e),[]),C=async e=>{r(!0),n.post(`${d.API_URL}/ticket/delete`,{ticket_id:e},{params:{store_id:i.config.shop}}).then(o=>{g(),l(),r(!1),k(o.data.message)}).catch(o=>{console.log(o)})},_=async()=>{await n.get(`${d.API_URL}/stores/get`,{params:{store_id:i.config.shop}}).then(e=>{e.data.success===!0&&S(e.data.data.integration_type)}).catch(e=>{console.log(e)})},g=async()=>{n.get(`${d.API_URL}/tickets`,{params:{store_id:i.config.shop}}).then(e=>{var o=[];e.data.data.map(c=>{let s=new Date(c.createdAt);s=`${s.getDate()}-${s.getMonth()}-${s.getFullYear()} ${s.getHours()}:${s.getMinutes()}:${s.getSeconds()}`,o.push([c.subject,c.customer_email,c.status==0?"Closed":"Active",s,t.jsx(t.Fragment,{children:t.jsxs(A,{children:[t.jsx(p,{variant:"primary",tone:"critical",onClick:()=>C(c._id),children:"Delete"}),t.jsx("div",{className:"viewTicketBtn",children:t.jsx(p,{children:t.jsx(w,{to:`/app/view_ticket/${c._id}`,children:"view"})})})]})})])}),h(o),r(!1)}).catch(e=>{console.error("Error fetching data:",e)})};return a.useEffect(()=>{_()},[]),a.useEffect(()=>{g()},[T]),t.jsxs(L,{children:[x?t.jsx($,{}):"",t.jsxs(b,{gap:"200",children:[t.jsx(D,{children:t.jsx(I,{variants:"headingMd",as:"h1",children:"Tickets"})}),t.jsx(B,{children:t.jsx(M,{columnContentTypes:["text","text","text","text","text"],headings:["Subject","Customer Email","Status","Created at","Actions"],rows:u})})]}),m?t.jsx(y,{message:j,toggle:l}):""]})}export{q as default};
