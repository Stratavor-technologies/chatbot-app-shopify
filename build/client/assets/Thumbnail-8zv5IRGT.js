import{R as r,r as n}from"./jsx-runtime-DexIYAB0.js";import{u as ge,d as z,f as ae,B as ee,T as te,h as Le,i as _e,j as X,k as T,l as Oe,v as he,L as $e,S as Be}from"./Page-g_6naJ0r.js";import{I as We}from"./Toast-Ckam4cjg.js";var re=function(t){return r.createElement("svg",Object.assign({viewBox:"0 0 20 20"},t),r.createElement("path",{d:"M16.5 6.26a.75.75 0 0 1-1.5 0v-.51a.75.75 0 0 0-.75-.75h-8.5a.75.75 0 0 0-.75.75v.51a.75.75 0 0 1-1.5 0v-.51a2.25 2.25 0 0 1 2.25-2.25h8.5a2.25 2.25 0 0 1 2.25 2.25v.51Z"}),r.createElement("path",{d:"M10.75 16.01a.75.75 0 0 1-1.5 0v-6.69l-1.72 1.72a.75.75 0 1 1-1.06-1.06l3-3a.75.75 0 0 1 1.06 0l3 3a.75.75 0 1 1-1.06 1.06l-1.72-1.72v6.69Z"}))};re.displayName="UploadIcon";function ye(e=""){const t=e.toLowerCase();return t.charAt(0).toUpperCase()+t.slice(1)}const je=["dragover","dragenter","drop"];function Re(e,t){return e.type==="application/x-moz-file"||He(e,t)}function fe(e){if(Ke(e)&&e.dataTransfer){const t=e.dataTransfer;if(t.files&&t.files.length)return Array.from(t.files);if(t.items&&t.items.length)return Array.from(t.items)}else if(qe(e)&&e.target.files)return Array.from(e.target.files);return[]}function He(e,t){if(e&&t){const o=e.name||"",p=e.type||"",h=p.replace(/\/.*$/,"");return(Array.isArray(t)?t:t.split(",")).some(s=>{const u=s.trim();return u.startsWith(".")?o.toLowerCase().endsWith(u.toLowerCase()):u.endsWith("/*")?h===u.replace(/\/.*$/,""):p===u})}return!0}function Ke(e){return je.indexOf(e.type)>0}function qe(e){return Object.prototype.hasOwnProperty.call(e,"target")}const Ee=!0;function be(e){return e?"allowMultiple":"single"}const ve=n.createContext({disabled:!1,focused:!1,size:"extraLarge",type:"file",measuring:!1,allowMultiple:Ee});var c={DropZone:"Polaris-DropZone",focused:"Polaris-DropZone--focused",noOutline:"Polaris-DropZone--noOutline",hasOutline:"Polaris-DropZone--hasOutline",isDisabled:"Polaris-DropZone--isDisabled",isDragging:"Polaris-DropZone--isDragging",sizeLarge:"Polaris-DropZone--sizeLarge",sizeMedium:"Polaris-DropZone--sizeMedium",sizeSmall:"Polaris-DropZone--sizeSmall",measuring:"Polaris-DropZone--measuring",Container:"Polaris-DropZone__Container",Overlay:"Polaris-DropZone__Overlay",hasError:"Polaris-DropZone--hasError"},g={FileUpload:"Polaris-DropZone-FileUpload",large:"Polaris-DropZone-FileUpload--large",small:"Polaris-DropZone-FileUpload--small",Action:"Polaris-DropZone-FileUpload__Action",disabled:"Polaris-DropZone-FileUpload--disabled",ActionTitle:"Polaris-DropZone-FileUpload__ActionTitle","ActionTitle-disabled":"Polaris-DropZone-FileUpload__ActionTitle--disabled","ActionTitle-focused":"Polaris-DropZone-FileUpload__ActionTitle--focused",UploadIcon:"Polaris-DropZone-FileUpload__UploadIcon"};function Ve(e){const t=ge(),{size:o,measuring:p,type:h,disabled:y,allowMultiple:s}=n.useContext(ve),u=ye(h),v=be(s),{actionTitle:S=t.translate(`Polaris.DropZone.${v}.actionTitle${u}`),actionHint:A}=e,d=z(g.Action,y&&g.disabled),D=r.createElement("div",{className:d},S),C=z(g.FileUpload,p&&g.measuring,o==="large"&&g.large,o==="small"&&g.small),U=A&&r.createElement(te,{variant:"bodySm",as:"p",tone:"subdued"},A);let m;switch(o){case"large":m=r.createElement(ee,{inlineAlign:"center",gap:"200"},D,U);break;case"medium":m=r.createElement(ee,{inlineAlign:"center",gap:"200"},D,U);break;case"small":m=r.createElement("div",{className:z(g.UploadIcon,y&&g.disabled)},r.createElement(ae,{source:re}));break}return r.createElement("div",{className:C},m)}const Ge=function({dropOnPage:t,label:o,labelAction:p,labelHidden:h,children:y,disabled:s=!1,outline:u=!0,accept:v,active:S,overlay:A=!0,allowMultiple:d=Ee,overlayText:D,errorOverlayText:C,id:U,type:m="file",onClick:ne,error:L,openFileDialog:se,variableHeight:le,onFileDialogClose:k,customValidator:_,onDrop:O,onDropAccepted:$,onDropRejected:B,onDragEnter:W,onDragOver:j,onDragLeave:R}){const P=n.useRef(null),x=n.useRef(null),E=n.useRef([]),ie=n.useCallback(Le(()=>{if(!P.current)return;if(le){oe(!1);return}let a="large";const l=P.current.getBoundingClientRect().width;l<100?a="small":l<160&&(a="medium"),Ze(a),F&&oe(!1)},50,{trailing:!0}),[]),[Z,H]=n.useState(!1),[K,q]=n.useState(!1),{value:V,setTrue:De,setFalse:Pe}=_e(!1),[b,Ze]=n.useState("large"),[F,oe]=n.useState(!0),G=ge(),M=n.useCallback(a=>{const l=[],i=[];return Array.from(a).forEach(f=>{!Re(f,v)||_&&!_(f)?i.push(f):l.push(f)}),d||(l.splice(1,l.length),i.push(...l.slice(1))),{files:a,acceptedFiles:l,rejectedFiles:i}},[v,d,_]),ce=n.useCallback(a=>{if(I(a),s)return;const l=fe(a),{files:i,acceptedFiles:f,rejectedFiles:w}=M(l);E.current=[],H(!1),q(w.length>0),O&&O(i,f,w),$&&f.length&&$(f),B&&w.length&&B(w),a.target&&"value"in a.target&&(a.target.value="")},[s,M,O,$,B]),Te=n.useCallback(a=>{if(I(a),s)return;const l=fe(a);if(a.target&&!E.current.includes(a.target)&&E.current.push(a.target),Z)return;const{rejectedFiles:i}=M(l);H(!0),q(i.length>0),W&&W()},[s,Z,M,W]),ze=n.useCallback(a=>{I(a),!s&&j&&j()},[s,j]),Se=n.useCallback(a=>{a.preventDefault(),!s&&(E.current=E.current.filter(l=>{const i=t&&!X?document:P.current;return l!==a.target&&i&&i.contains(l)}),!(E.current.length>0)&&(H(!1),q(!1),R&&R()))},[t,s,R]),N=t&&!X?document:P.current;T("drop",ce,N),T("dragover",ze,N),T("dragenter",Te,N),T("dragleave",Se,N),T("resize",ie,X?null:window),Oe(()=>{ie()});const Ae=n.useId(),ue=U??Ae,J=ye(m),pe=be(d),Ce=D===void 0?G.translate(`Polaris.DropZone.${pe}.overlayText${J}`):D,Ue=C===void 0?G.translate(`Polaris.DropZone.errorOverlayText${J}`):C,ke=o||G.translate(`Polaris.DropZone.${pe}.label${J}`),xe=o?h:!0,Fe=z(c.DropZone,u&&c.hasOutline,!u&&c.noOutline,V&&c.focused,(S||Z)&&c.isDragging,s&&c.isDisabled,(K||L)&&c.hasError,!le&&c[he("size",b)],F&&c.measuring),Me=(S||Z)&&!K&&!L&&A&&me(re,Ce),Ne=Z&&(K||L)&&me(Be,Ue,"critical"),we=n.useMemo(()=>({disabled:s,focused:V,size:b,type:m||"file",measuring:F,allowMultiple:d}),[s,V,F,b,m,d]),Q=n.useCallback(()=>{x.current&&x.current.click()},[x]),de=n.useCallback(()=>{Q(),k==null||k()},[Q,k]);function me(a,l,i){return r.createElement("div",{className:c.Overlay},r.createElement(ee,{gap:"200",inlineAlign:"center"},b==="small"&&r.createElement(ae,{source:a,tone:i}),(b==="medium"||b==="large")&&r.createElement(te,{variant:"bodySm",as:"p",fontWeight:"bold"},l)))}function Ie(a){if(!s)return ne?ne(a):Q()}return n.useEffect(()=>{se&&de()},[se,de]),r.createElement(ve.Provider,{value:we},r.createElement($e,{id:ue,label:ke,action:p,labelHidden:xe},r.createElement("div",{ref:P,className:Fe,"aria-disabled":s,onClick:Ie,onDragStart:I},Me,Ne,r.createElement(te,{variant:"bodySm",as:"span",visuallyHidden:!0},r.createElement("input",{id:ue,accept:v,disabled:s,multiple:d,onChange:ce,onFocus:De,onBlur:Pe,type:"file",ref:x,autoComplete:"off"})),r.createElement("div",{className:c.Container},y))))};function I(e){e.preventDefault(),e.stopPropagation()}Ge.FileUpload=Ve;var Y={Thumbnail:"Polaris-Thumbnail",sizeExtraSmall:"Polaris-Thumbnail--sizeExtraSmall",sizeSmall:"Polaris-Thumbnail--sizeSmall",sizeMedium:"Polaris-Thumbnail--sizeMedium",sizeLarge:"Polaris-Thumbnail--sizeLarge",transparent:"Polaris-Thumbnail--transparent"};function Ye({source:e,alt:t,size:o="medium",transparent:p}){const h=z(Y.Thumbnail,o&&Y[he("size",o)],p&&Y.transparent),y=typeof e=="string"?r.createElement(We,{alt:t,source:e}):r.createElement(ae,{accessibilityLabel:t,source:e});return r.createElement("span",{className:h},y)}export{Ge as D,Ye as T};
